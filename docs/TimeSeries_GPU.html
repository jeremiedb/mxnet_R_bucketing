<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.8.0.9000/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.40.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.40.1/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-1.0.0/grViz.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET R</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU.html">GPU</a></li>
        <li><a href="TimeSeries_CPU.html">CPU</a></li>
        </ul>
  </li>
  
    <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Vision<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="ClassActivationMap.html">Activation Map</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="CNN_NLP_Classification.html">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<p>In this step, a dataset made of multiple univariate time-series is built. 500 independent times series (<em>n</em>) with each 100 observations (<em>seq_len</em>) are created.</p>
<p>The modeling task will be to predict the next value given the previous ones. The target variable can therefore be obtained by shifting the features by one timestep in the future.</p>
<p>The resulting data is of shape [1, 100, 500] corresponding to [num_features, seq_length, samples]. In multivariate time-series, the dataset would follow the same structure, except that the num_features would be &gt; 1.</p>
<pre class="r"><code># number of timestamps
seq_len = 100

# number of samples
n = 500

# return a random starting point of the time series
set.seed(12)
seeds &lt;- runif(n, min = 0, max = 24)

# generate the time series of seq_length for each starting point
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

# build the features matrix
x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, n))

# build the target array - same as feature but one timestep forward
y &lt;- pts[-1, ]

# plot time series from 5 first samples
plot_ly(x = 1:dim(x)[2], y = x[,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  layout(title = &quot;Sample of 5 time series&quot;)</code></pre>
<div id="htmlwidget-5359762f84bab53d6980" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5359762f84bab53d6980">{"x":{"visdat":{"19cc4a4317e3":["function () ","plotlyVisDat"]},"cur_data":"19cc4a4317e3","attrs":{"19cc4a4317e3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"19cc4a4317e3.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.70117834568943,0.861820608905392,0.963731221850346,0.999965144667347,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700609,0.266874749706372,0.00834921855102572,-0.250745298050841,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456416,-0.712985923799507,-0.507213207700609,-0.266874749706372,-0.00834921855102584,0.25074529805084,0.492751936966736,0.701178345689429,0.861820608905392,0.963731221850346,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799507,0.50721320770061,0.266874749706376,0.00834921855102596,-0.25074529805084,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456418,-0.712985923799507,-0.50721320770061,-0.266874749706373,-0.00834921855102609,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850347,0.999965144667346,0.968053095395803,0.870169827456416,0.71298592379951,0.507213207700607,0.266874749706376,0.00834921855102621,-0.25074529805084,-0.492751936966733,-0.701178345689427,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395804,-0.870169827456414,-0.712985923799508,-0.50721320770061,-0.266874749706373,-0.00834921855102988,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850345,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700613,0.266874749706376,0.00834921855102645,-0.250745298050833,-0.492751936966739,-0.701178345689426,-0.861820608905389,-0.963731221850346,-0.999965144667346,-0.968053095395803,-0.870169827456418,-0.712985923799508,-0.50721320770061,-0.26687474970638,-0.00834921855102302,0.250745298050836,0.492751936966735,0.701178345689429,0.861820608905388,0.963731221850346,0.999965144667346],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"19cc4a4317e3.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345788,-0.403578406307372,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254405,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.932336886940122,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823962,-0.107963379671007,-0.361590831259314,-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233053,-0.626632013345788,-0.403578406307375,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254402,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823959,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904059,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233055,-0.626632013345785,-0.403578406307375,-0.153021597823963,0.107963379671006,0.36159083125931,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.93233688694012,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823966,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904056,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345791,-0.403578406307376,-0.153021597823963,0.107963379670999,0.361590831259317,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605102,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307379,0.153021597823959,-0.107963379671003,-0.361590831259313,-0.590576465254404,-0.779315289116156,-0.914945063904059,-0.988222844605103],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"19cc4a4317e3.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.180976961168064,0.429355573857644,0.648474313732461,0.823400600780882,0.942213497619918,0.996816101677582,0.983487335722414,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989953,0.0797349323465505,-0.180976961168064,-0.429355573857644,-0.64847431373246,-0.823400600780882,-0.942213497619917,-0.996816101677582,-0.983487335722414,-0.903135533127433,-0.761236536451854,-0.567460527819938,-0.335013021989954,-0.0797349323465524,0.180976961168064,0.429355573857644,0.64847431373246,0.823400600780882,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989955,0.0797349323465525,-0.180976961168064,-0.429355573857642,-0.64847431373246,-0.823400600780883,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127433,-0.761236536451853,-0.567460527819938,-0.335013021989957,-0.0797349323465527,0.180976961168064,0.429355573857645,0.64847431373246,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451856,0.567460527819938,0.335013021989954,0.0797349323465528,-0.18097696116806,-0.429355573857642,-0.64847431373246,-0.823400600780881,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989957,-0.0797349323465529,0.180976961168063,0.429355573857642,0.648474313732459,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127434,0.761236536451856,0.567460527819939,0.335013021989957,0.079734932346553,-0.180976961168063,-0.429355573857642,-0.648474313732459,-0.82340060078088,-0.942213497619917,-0.996816101677581,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989958,-0.0797349323465531,0.180976961168063,0.429355573857642,0.648474313732462,0.82340060078088],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"19cc4a4317e3.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871935,-0.921386408957596,-0.78940148493583,-0.603620154263324,-0.376703107607241,-0.124114366699045,0.136932563191003,0.388647765191344,0.613877264264695,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263324,0.376703107607241,0.124114366699045,-0.136932563191002,-0.388647765191345,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607241,-0.124114366699045,0.136932563191002,0.388647765191343,0.613877264264693,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935832,0.603620154263324,0.376703107607242,0.124114366699045,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191344,0.613877264264693,0.797272042258549,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263325,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263326,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191341,0.613877264264693,0.797272042258551,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935833,0.603620154263326,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Sample of 5 time series","xaxis":{"domain":[0,1],"automargin":true,"title":[]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.70117834568943,0.861820608905392,0.963731221850346,0.999965144667347,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700609,0.266874749706372,0.00834921855102572,-0.250745298050841,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456416,-0.712985923799507,-0.507213207700609,-0.266874749706372,-0.00834921855102584,0.25074529805084,0.492751936966736,0.701178345689429,0.861820608905392,0.963731221850346,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799507,0.50721320770061,0.266874749706376,0.00834921855102596,-0.25074529805084,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456418,-0.712985923799507,-0.50721320770061,-0.266874749706373,-0.00834921855102609,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850347,0.999965144667346,0.968053095395803,0.870169827456416,0.71298592379951,0.507213207700607,0.266874749706376,0.00834921855102621,-0.25074529805084,-0.492751936966733,-0.701178345689427,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395804,-0.870169827456414,-0.712985923799508,-0.50721320770061,-0.266874749706373,-0.00834921855102988,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850345,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700613,0.266874749706376,0.00834921855102645,-0.250745298050833,-0.492751936966739,-0.701178345689426,-0.861820608905389,-0.963731221850346,-0.999965144667346,-0.968053095395803,-0.870169827456418,-0.712985923799508,-0.50721320770061,-0.26687474970638,-0.00834921855102302,0.250745298050836,0.492751936966735,0.701178345689429,0.861820608905388,0.963731221850346,0.999965144667346],"mode":"lines","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345788,-0.403578406307372,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254405,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.932336886940122,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823962,-0.107963379671007,-0.361590831259314,-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233053,-0.626632013345788,-0.403578406307375,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254402,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823959,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904059,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233055,-0.626632013345785,-0.403578406307375,-0.153021597823963,0.107963379671006,0.36159083125931,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.93233688694012,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823966,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904056,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345791,-0.403578406307376,-0.153021597823963,0.107963379670999,0.361590831259317,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605102,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307379,0.153021597823959,-0.107963379671003,-0.361590831259313,-0.590576465254404,-0.779315289116156,-0.914945063904059,-0.988222844605103],"mode":"lines","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.180976961168064,0.429355573857644,0.648474313732461,0.823400600780882,0.942213497619918,0.996816101677582,0.983487335722414,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989953,0.0797349323465505,-0.180976961168064,-0.429355573857644,-0.64847431373246,-0.823400600780882,-0.942213497619917,-0.996816101677582,-0.983487335722414,-0.903135533127433,-0.761236536451854,-0.567460527819938,-0.335013021989954,-0.0797349323465524,0.180976961168064,0.429355573857644,0.64847431373246,0.823400600780882,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989955,0.0797349323465525,-0.180976961168064,-0.429355573857642,-0.64847431373246,-0.823400600780883,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127433,-0.761236536451853,-0.567460527819938,-0.335013021989957,-0.0797349323465527,0.180976961168064,0.429355573857645,0.64847431373246,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451856,0.567460527819938,0.335013021989954,0.0797349323465528,-0.18097696116806,-0.429355573857642,-0.64847431373246,-0.823400600780881,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989957,-0.0797349323465529,0.180976961168063,0.429355573857642,0.648474313732459,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127434,0.761236536451856,0.567460527819939,0.335013021989957,0.079734932346553,-0.180976961168063,-0.429355573857642,-0.648474313732459,-0.82340060078088,-0.942213497619917,-0.996816101677581,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989958,-0.0797349323465531,0.180976961168063,0.429355573857642,0.648474313732462,0.82340060078088],"mode":"lines","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871935,-0.921386408957596,-0.78940148493583,-0.603620154263324,-0.376703107607241,-0.124114366699045,0.136932563191003,0.388647765191344,0.613877264264695,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263324,0.376703107607241,0.124114366699045,-0.136932563191002,-0.388647765191345,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607241,-0.124114366699045,0.136932563191002,0.388647765191343,0.613877264264693,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935832,0.603620154263324,0.376703107607242,0.124114366699045,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191344,0.613877264264693,0.797272042258549,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263325,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263326,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191341,0.613877264264693,0.797272042258551,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935833,0.603620154263326,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936],"mode":"lines","type":"scatter","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"line":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<pre class="r"><code># plot first time series and its associated target
plot_ly(x = 1:dim(x)[2], y = x[,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;, name = &quot;feature&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;, name = &quot;target&quot;) %&gt;% 
  layout(title = &quot;Sample of one time series&quot;)</code></pre>
<div id="htmlwidget-a74b8cf5905f19d81eab" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a74b8cf5905f19d81eab">{"x":{"visdat":{"19cc71b9bca":["function () ","plotlyVisDat"]},"cur_data":"19cc71b9bca","attrs":{"19cc71b9bca":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","name":"feature","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"19cc71b9bca.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"target","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Sample of one time series","xaxis":{"domain":[0,1],"automargin":true,"title":[]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","name":"feature","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"target","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<p>The training and evaluation data are obtained by splitting the first 400 and the remaining observations into different <code>mx.io.arrayiter</code> iterators.</p>
<pre class="r"><code>batch.size = 32

# take first 400 samples for train - remaining 100 for evaluation
train_ids &lt;- 1:400

train.data &lt;- mx.io.arrayiter(data = x[,,train_ids, drop = F], label = y[, train_ids], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-train_ids, drop = F], label = y[, -train_ids], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph(num_rnn_layer =  2, 
                    num_hidden = 50,
                    input_size = NULL,
                    num_embed = NULL, 
                    num_decode = 1,
                    masking = F, 
                    loss_output = &quot;linear&quot;,
                    dropout = 0.2, 
                    ignore_label = -1,
                    cell_type = &quot;lstm&quot;,
                    output_last_state = T,
                    config = &quot;one-to-one&quot;)

graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;LR&quot;, 
          shape=list(data = c(1, seq_len, batch.size), 
                     label = c(seq_len, batch.size)),
          graph.width.px = 800, graph.height.px = 220)</code></pre>
<div id="htmlwidget-8cb4f54447ec53827770" style="width:800px;height:220px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-8cb4f54447ec53827770">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"RNN\nRNN\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"5\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"7\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"8\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"9\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [color = \"black\", fontcolor = \"black\", label = \"1X100X32\"] \n\"2\"->\"3\" [color = \"black\", fontcolor = \"black\", label = \"1X32X100\"] \n\"3\"->\"4\" [color = \"black\", fontcolor = \"black\", label = \"50X32X100\"] \n\"4\"->\"5\" [color = \"black\", fontcolor = \"black\", label = \"50X32X100\"] \n\"5\"->\"6\" [color = \"black\", fontcolor = \"black\", label = \"50X100X32\"] \n\"6\"->\"7\" [color = \"black\", fontcolor = \"black\", label = \"50X3200\"] \n\"7\"->\"9\" [color = \"black\", fontcolor = \"black\", label = \"1X3200\"] \n\"8\"->\"9\" [color = \"black\", fontcolor = \"black\", label = \"3200\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;Perplexity&quot;, function(label, pred) {
  label = mx.nd.reshape(label, shape = -1)
  pred = mx.nd.reshape(pred, shape = -1)
  res &lt;- mx.nd.mean(mx.nd.square(label-pred))
  return(as.array(res))
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.gpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 3)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.9, eps = 1e-5, wd = 1e-6,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 100, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
##   31.94    9.11   31.61</code></pre>
<pre class="r"><code>plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
        mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)</code></pre>
<div id="htmlwidget-9c178ac47f0bf5ab798d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9c178ac47f0bf5ab798d">{"x":{"visdat":{"19ccd237ba6":["function () ","plotlyVisDat"]},"cur_data":"19ccd237ba6","attrs":{"19ccd237ba6":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.288667187094688,0.0844010730775503,0.0353757122961374,0.0271030220274742,0.0257160904315802,0.0299983887145152,0.0271822927662959,0.019620404793666,0.0205091145605995,0.0254039963564047,0.0186076394927043,0.0169953435945969,0.0227445477189926,0.0215915816907699,0.0164672377017828,0.0164001560411774,0.0209219813203582,0.0183098551172477,0.0150691476435615,0.0139160480063695,0.0174489129477969,0.0180015474414596,0.013530844106124,0.0125564016545048,0.014049417195985,0.015798778559726,0.0121139070162406,0.0106505735132557,0.0108759491346203,0.00917027321142646,0.0154696907131718,0.0104233506135643,0.0091802655146099,0.00897125509352638,0.00761585825910935,0.0109458974061104,0.00892850359042103,0.00704569197618044,0.00874528725846456,0.007366043730424,0.00703354545224171,0.00712215696246578,0.0106537955669829,0.00814520051846137,0.00686361672929846,0.00649802343776593,0.00676341587677598,0.00745315301733521,0.00604920977583298,0.00747669319837139,0.00757255856520854,0.00679787807166576,0.00603952763888698,0.00670645178224032,0.00592383205030973,0.00676848094623822,0.00678518815682485,0.00631089587337696,0.00586304136623557,0.00694471791100044,0.00584493230025356,0.00627602690544266,0.00603660167409823,0.0062601574195119,0.00619229513148849,0.00588552249022401,0.00556967916110387,0.0060487982387153,0.00657637700295219,0.00586520314503175,0.00508940452709794,0.00575575841447482,0.00562153466475698,0.00576098019687029,0.00552559361005059,0.00529090530024125,0.00568301879012814,0.00530968549159857,0.00517879526775617,0.00561727228789375,0.00504661319204248,0.00527050192109667,0.00523021011255108,0.00600673451733131,0.00533290798417651,0.00511942714309463,0.00516915332096127,0.00561940888516032,0.00604678210444175,0.00577016586724382,0.00517137957593569,0.00534934991110976,0.0049479752420806,0.00501138097248398,0.0056911395289577,0.00543640245898412,0.00496849045157433,0.00506240935423053,0.00514700446421137,0.00549323795936429],"mode":"markers+lines","name":"train","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"19ccd237ba6.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.219799607992172,0.0228186957538128,0.042710947804153,0.0190726020373404,0.0238168714568019,0.0391871063038707,0.014765108935535,0.0161859504878521,0.0451477551832795,0.0139243451412767,0.0185804916545749,0.0120629542507231,0.0278601706959307,0.0118553296197206,0.0180089506320655,0.0109032629989088,0.0277584958821535,0.0105236296076328,0.0144781479611993,0.00982943875715137,0.0251955804415047,0.0102783173788339,0.0137144098989666,0.00818978436291218,0.0255310293287039,0.00962753058411181,0.0115093027707189,0.00834695808589458,0.0102521094959229,0.00808593304827809,0.00845328718423843,0.0091200890019536,0.00629215291701257,0.00884951534681022,0.00795013201422989,0.00731852021999657,0.00772443017922342,0.0079998061992228,0.00571234175004065,0.00703118473757058,0.00495803216472268,0.0122398149687797,0.00676490273326635,0.007571886992082,0.00517504289746284,0.00561094237491488,0.0080969447735697,0.00509525008965284,0.00611230242066085,0.00887741800397635,0.00573264446575195,0.00580578588414937,0.00738788186572492,0.00492264027707279,0.00572616676799953,0.00771585386246443,0.00537914538290352,0.00591733050532639,0.00693755154497921,0.00494621973484755,0.00490090646781027,0.00590694998390973,0.00522187363822013,0.00514813233166933,0.00618979160208255,0.00430472730658948,0.00557036849204451,0.00750100892037153,0.00507296645082533,0.00536821456626058,0.00479498202912509,0.00452657544519752,0.00500300549902022,0.00477010128088295,0.00543655117508024,0.00578003516420722,0.0046386084286496,0.00435929314699024,0.00485287676565349,0.00507073244079947,0.00432500510942191,0.00523160339798778,0.00443463225383312,0.00458684947807342,0.00532289955299348,0.00412895961198956,0.00523565639741719,0.00644035346340388,0.0046595276799053,0.00562880816869438,0.00527224014513195,0.00417029962409288,0.00502507656347007,0.00540469854604453,0.00454264029394835,0.00541265704669058,0.00457808398641646,0.00431666499935091,0.00478772062342614,0.00511702534276992],"mode":"markers+lines","name":"eval","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":[]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.288667187094688,0.0844010730775503,0.0353757122961374,0.0271030220274742,0.0257160904315802,0.0299983887145152,0.0271822927662959,0.019620404793666,0.0205091145605995,0.0254039963564047,0.0186076394927043,0.0169953435945969,0.0227445477189926,0.0215915816907699,0.0164672377017828,0.0164001560411774,0.0209219813203582,0.0183098551172477,0.0150691476435615,0.0139160480063695,0.0174489129477969,0.0180015474414596,0.013530844106124,0.0125564016545048,0.014049417195985,0.015798778559726,0.0121139070162406,0.0106505735132557,0.0108759491346203,0.00917027321142646,0.0154696907131718,0.0104233506135643,0.0091802655146099,0.00897125509352638,0.00761585825910935,0.0109458974061104,0.00892850359042103,0.00704569197618044,0.00874528725846456,0.007366043730424,0.00703354545224171,0.00712215696246578,0.0106537955669829,0.00814520051846137,0.00686361672929846,0.00649802343776593,0.00676341587677598,0.00745315301733521,0.00604920977583298,0.00747669319837139,0.00757255856520854,0.00679787807166576,0.00603952763888698,0.00670645178224032,0.00592383205030973,0.00676848094623822,0.00678518815682485,0.00631089587337696,0.00586304136623557,0.00694471791100044,0.00584493230025356,0.00627602690544266,0.00603660167409823,0.0062601574195119,0.00619229513148849,0.00588552249022401,0.00556967916110387,0.0060487982387153,0.00657637700295219,0.00586520314503175,0.00508940452709794,0.00575575841447482,0.00562153466475698,0.00576098019687029,0.00552559361005059,0.00529090530024125,0.00568301879012814,0.00530968549159857,0.00517879526775617,0.00561727228789375,0.00504661319204248,0.00527050192109667,0.00523021011255108,0.00600673451733131,0.00533290798417651,0.00511942714309463,0.00516915332096127,0.00561940888516032,0.00604678210444175,0.00577016586724382,0.00517137957593569,0.00534934991110976,0.0049479752420806,0.00501138097248398,0.0056911395289577,0.00543640245898412,0.00496849045157433,0.00506240935423053,0.00514700446421137,0.00549323795936429],"mode":"markers+lines","name":"train","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.219799607992172,0.0228186957538128,0.042710947804153,0.0190726020373404,0.0238168714568019,0.0391871063038707,0.014765108935535,0.0161859504878521,0.0451477551832795,0.0139243451412767,0.0185804916545749,0.0120629542507231,0.0278601706959307,0.0118553296197206,0.0180089506320655,0.0109032629989088,0.0277584958821535,0.0105236296076328,0.0144781479611993,0.00982943875715137,0.0251955804415047,0.0102783173788339,0.0137144098989666,0.00818978436291218,0.0255310293287039,0.00962753058411181,0.0115093027707189,0.00834695808589458,0.0102521094959229,0.00808593304827809,0.00845328718423843,0.0091200890019536,0.00629215291701257,0.00884951534681022,0.00795013201422989,0.00731852021999657,0.00772443017922342,0.0079998061992228,0.00571234175004065,0.00703118473757058,0.00495803216472268,0.0122398149687797,0.00676490273326635,0.007571886992082,0.00517504289746284,0.00561094237491488,0.0080969447735697,0.00509525008965284,0.00611230242066085,0.00887741800397635,0.00573264446575195,0.00580578588414937,0.00738788186572492,0.00492264027707279,0.00572616676799953,0.00771585386246443,0.00537914538290352,0.00591733050532639,0.00693755154497921,0.00494621973484755,0.00490090646781027,0.00590694998390973,0.00522187363822013,0.00514813233166933,0.00618979160208255,0.00430472730658948,0.00557036849204451,0.00750100892037153,0.00507296645082533,0.00536821456626058,0.00479498202912509,0.00452657544519752,0.00500300549902022,0.00477010128088295,0.00543655117508024,0.00578003516420722,0.0046386084286496,0.00435929314699024,0.00485287676565349,0.00507073244079947,0.00432500510942191,0.00523160339798778,0.00443463225383312,0.00458684947807342,0.00532289955299348,0.00412895961198956,0.00523565639741719,0.00644035346340388,0.0046595276799053,0.00562880816869438,0.00527224014513195,0.00417029962409288,0.00502507656347007,0.00540469854604453,0.00454264029394835,0.00541265704669058,0.00457808398641646,0.00431666499935091,0.00478772062342614,0.00511702534276992],"mode":"markers+lines","name":"eval","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>internals &lt;- model$symbol$get.internals()
sym_state &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state&quot;))
sym_state_cell &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state_cell&quot;))
sym_output &lt;- internals$get.output(which(internals$outputs %in% &quot;loss_output&quot;))
symbol &lt;- mx.symbol.Group(sym_output, sym_state, sym_state_cell)

pred_length = 100
predict &lt;- numeric()

data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

infer.data &lt;- mx.io.arrayiter(data = data, label = label, 
                              batch.size = 1, shuffle = FALSE)

infer &lt;- mx.infer.rnn.one(infer.data = infer.data, 
                          symbol = symbol,
                          arg.params = model$arg.params, 
                          aux.params = model$aux.params, 
                          input.params = NULL,
                          ctx = ctx)

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  label = pred
  
  infer.data &lt;- mx.io.arrayiter(data = data, label = label,  
                                batch.size = 1, shuffle = FALSE)
  
  infer &lt;- mx.infer.rnn.one(infer.data = infer.data, 
                            symbol = symbol,
                            ctx = ctx,
                            arg.params = model$arg.params,
                            aux.params = model$aux.params,
                            input.params = list(rnn.state = infer[[2]], 
                                                rnn.state.cell = infer[[3]]))
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
  
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data &lt;- mx.nd.array(x[, , 1, drop = F])
label &lt;- mx.nd.array(y[, 1, drop = F])

plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)</code></pre>
<div id="htmlwidget-0125a744bf536d6c58e1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0125a744bf536d6c58e1">{"x":{"visdat":{"19cc1bb22f63":["function () ","plotlyVisDat"]},"cur_data":"19cc1bb22f63","attrs":{"19cc1bb22f63":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"hist","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"19cc1bb22f63.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.167145510337144,-0.0937278752506381,-0.348213861032726,-0.578969647636044,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.093727875250638,0.348213861032723,0.578969647636047,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252508,0.937415119882691,0.815349095244605,0.637718377193685,0.416628205616462,0.16714551033714,-0.0937278752506343,-0.348213861032723,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193682,-0.416628205616465,-0.167145510337144,0.0937278752506377,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244605,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506341,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882693,-0.815349095244603,-0.637718377193688,-0.416628205616465,-0.167145510337144,0.0937278752506375,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244606,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506338,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.90907697049524,-0.985932238226408,-0.995597853252507,-0.937415119882693,-0.815349095244604,-0.637718377193688,-0.416628205616466,-0.167145510337144,0.0937278752506372,0.348213861032725,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244606,0.637718377193686,0.416628205616463,0.167145510337148,-0.0937278752506336,-0.348213861032722,-0.578969647636044],"mode":"lines","name":"real","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true},"19cc1bb22f63.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.135174542665482,-0.172683387994766,-0.457176208496094,-0.678888082504272,-0.867060899734497,-0.983004212379456,-1.01436948776245,-0.985859274864197,-0.902269303798676,-0.775055289268494,-0.613918244838715,-0.450072824954987,-0.316316455602646,-0.21502573788166,-0.118510752916336,0.0115894079208374,0.190120503306389,0.376661449670792,0.54956442117691,0.709036588668823,0.809579312801361,0.842656254768372,0.829617321491241,0.787101030349731,0.707452595233917,0.571146845817566,0.348916053771973,0.0963103622198105,-0.176482915878296,-0.450504422187805,-0.677040100097656,-0.865391671657562,-0.979195475578308,-1.00906872749329,-0.975412607192993,-0.884159028530121,-0.751234710216522,-0.589396893978119,-0.432336807250977,-0.307275772094727,-0.210574492812157,-0.11213581264019,0.0248161852359772,0.20857734978199,0.394249439239502,0.566602349281311,0.722306489944458,0.815752863883972,0.843198299407959,0.826946377754211,0.78203958272934,0.699092090129852,0.557487308979034,0.330184131860733,0.0774252712726593,-0.197303205728531,-0.468352377414703,-0.692116498947144,-0.876638412475586,-0.983879208564758,-1.00861656665802,-0.970610499382019,-0.875819027423859,-0.740091562271118,-0.57727712392807,-0.421961039304733,-0.299500614404678,-0.203912198543549,-0.103839874267578,0.0369011275470257,0.222672089934349,0.407000333070755,0.579008221626282,0.731583714485168,0.819769442081451,0.843192458152771,0.824616551399231,0.777501404285431,0.691111922264099,0.543786525726318,0.311627268791199,0.0582740269601345,-0.218477830290794,-0.486252129077911,-0.707337975502014,-0.887686133384705,-0.988223910331726,-1.00784516334534,-0.965381264686584,-0.867103636264801,-0.728550732135773,-0.564925312995911,-0.411523938179016,-0.291677504777908,-0.197035297751427,-0.0950609147548676,0.049625102430582,0.23713307082653,0.420044422149658,0.59169864654541],"mode":"lines","name":"pred","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":[]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"hist","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.167145510337144,-0.0937278752506381,-0.348213861032726,-0.578969647636044,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.093727875250638,0.348213861032723,0.578969647636047,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252508,0.937415119882691,0.815349095244605,0.637718377193685,0.416628205616462,0.16714551033714,-0.0937278752506343,-0.348213861032723,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193682,-0.416628205616465,-0.167145510337144,0.0937278752506377,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244605,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506341,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882693,-0.815349095244603,-0.637718377193688,-0.416628205616465,-0.167145510337144,0.0937278752506375,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244606,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506338,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.90907697049524,-0.985932238226408,-0.995597853252507,-0.937415119882693,-0.815349095244604,-0.637718377193688,-0.416628205616466,-0.167145510337144,0.0937278752506372,0.348213861032725,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244606,0.637718377193686,0.416628205616463,0.167145510337148,-0.0937278752506336,-0.348213861032722,-0.578969647636044],"mode":"lines","name":"real","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.135174542665482,-0.172683387994766,-0.457176208496094,-0.678888082504272,-0.867060899734497,-0.983004212379456,-1.01436948776245,-0.985859274864197,-0.902269303798676,-0.775055289268494,-0.613918244838715,-0.450072824954987,-0.316316455602646,-0.21502573788166,-0.118510752916336,0.0115894079208374,0.190120503306389,0.376661449670792,0.54956442117691,0.709036588668823,0.809579312801361,0.842656254768372,0.829617321491241,0.787101030349731,0.707452595233917,0.571146845817566,0.348916053771973,0.0963103622198105,-0.176482915878296,-0.450504422187805,-0.677040100097656,-0.865391671657562,-0.979195475578308,-1.00906872749329,-0.975412607192993,-0.884159028530121,-0.751234710216522,-0.589396893978119,-0.432336807250977,-0.307275772094727,-0.210574492812157,-0.11213581264019,0.0248161852359772,0.20857734978199,0.394249439239502,0.566602349281311,0.722306489944458,0.815752863883972,0.843198299407959,0.826946377754211,0.78203958272934,0.699092090129852,0.557487308979034,0.330184131860733,0.0774252712726593,-0.197303205728531,-0.468352377414703,-0.692116498947144,-0.876638412475586,-0.983879208564758,-1.00861656665802,-0.970610499382019,-0.875819027423859,-0.740091562271118,-0.57727712392807,-0.421961039304733,-0.299500614404678,-0.203912198543549,-0.103839874267578,0.0369011275470257,0.222672089934349,0.407000333070755,0.579008221626282,0.731583714485168,0.819769442081451,0.843192458152771,0.824616551399231,0.777501404285431,0.691111922264099,0.543786525726318,0.311627268791199,0.0582740269601345,-0.218477830290794,-0.486252129077911,-0.707337975502014,-0.887686133384705,-0.988223910331726,-1.00784516334534,-0.965381264686584,-0.867103636264801,-0.728550732135773,-0.564925312995911,-0.411523938179016,-0.291677504777908,-0.197035297751427,-0.0950609147548676,0.049625102430582,0.23713307082653,0.420044422149658,0.59169864654541],"mode":"lines","name":"pred","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
